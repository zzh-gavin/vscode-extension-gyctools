<?xml version="1.0"  encoding="UTF-8" ?>
<!--
//////////////////////////////////////////////////////////////////////////////////////
// 
// this file was generated by patella from the template named '/java/mybatis_dao.njk'. 
// 
// author: {{ customsAttributes.author }}
//////////////////////////////////////////////////////////////////////////////////////
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="{{customsAttributes.readerPackageName}}.{{className}}Reader">
	<resultMap id="{{className}}ResultMap" type="{{ customsAttributes.modelPackageName }}.{{ className }}">
        {% for property in properties %}
			{% if property.isInBaseModel==false %}
				{% if primaryKey and property.isPrimaryKey %}
		<result property="id" column="{{ property.columnName }}"/>
				{% else %}
        <result property="{{ property.propertyName }}" column="{{ property.columnName }}"/>
				{% endif %}
			{% endif %}
		{% endfor %}
		<result property="createTime" column="CREATE_TIME"/>
		<result property="updateTime" column="UPDATE_TIME"/>
		<result property="dr" column="dr" />
		<result property="dataVersion" column="data_version" />
	</resultMap>
	
	<sql id="selectClause">
		{% for property in properties %}
			{% if property.isInBaseModel==false %}
		{{ property.columnName }},
			{% endif %}
		{% endfor %}
		create_time,update_time,
		dr, data_version

	</sql>

	<!-- SELECT -->
	<sql id="baseSelect">
		select
		<include refid="selectClause" />
		from {{ tableName }}
	</sql>

    {% if primaryKey %}
	<select id="get" resultMap="{{className}}ResultMap">
		<include refid="baseSelect" />
		where
		{{primaryKey}} = #{id}
		limit 1
	</select>
	{% endif %}

	<select id="query" parameterType="com.sql.Where" resultMap="{{className}}ResultMap">
		<include refid="baseSelect" />
		<if test="join != null">
			${join}
		</if>
			${whereHead}
		<trim suffixOverrides="and">
		<if test="id != null">
		{% if primaryKey %}
		{{primaryKey}} = #{id} and 
		{% endif %}
		</if>
			${whereClause}
		</trim>
		<if test="groupBy != null">
			group by ${groupBy}
		</if>
		<if test="orderBy != null">
			order by ${orderBy}
		</if>
		<if test="pageSize != 0">
			limit #{startRow}, #{pageSize}
		</if>
	</select>
	
	<select id="count" parameterType="com.sql.Where" resultType="java.lang.Integer">
		select count(*) from {{ tableName }}
		<if test="join != null">
		${join}
		</if>
		${whereHead}
		${whereClause}
		<if test="groupBy != null">
		group by ${groupBy}
		</if>
	</select>

    <!-- Add manual codes in patella holding range , they will be reserved when anthour generation.-->
    <!-- patella:holding codes name=myCodes -->
    {{ holding.myCodes }}
    <!-- patella:end holding codes -->

</mapper>
